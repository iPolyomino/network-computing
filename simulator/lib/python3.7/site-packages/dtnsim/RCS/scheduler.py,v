head	1.4;
access;
symbols;
locks; strict;
comment	@# @;


1.4
date	2018.11.13.06.36.42;	author ohsaki;	state Exp;
branches;
next	1.3;

1.3
date	2018.10.15.11.45.14;	author ohsaki;	state Exp;
branches;
next	1.2;

1.2
date	2018.10.15.08.45.29;	author ohsaki;	state Exp;
branches;
next	1.1;

1.1
date	2018.05.27.08.31.34;	author ohsaki;	state Exp;
branches;
next	;


desc
@@


1.4
log
@*** empty log message ***
@
text
@#!/usr/bin/env python3
#
# A class for managing the simulator virtual clock.
# Copyright (c) 2018, Hiroyuki Ohsaki.
# All rights reserved.
#
# $Id: scheduler.py,v 1.3 2018/10/15 11:45:14 ohsaki Exp ohsaki $
#

VERSION = '1.0'

def version():
    return f"""
This is pydtnsim, version {VERSION}.
Copyright (c) 2010-2018, Hiroyuki Ohsaki.
All rights reserved."""

class Scheduler:
    def __init__(self, time=0, delta=10, max_time=10000):
        self.time = time  # simulation clock [s]
        self.delta = delta  # slot length [s]
        self.max_time = max_time
        self.agents = []
        self.zone_cache = {}

    def __repr__(self):
        name = self.__class__.__name__
        return f'{name}(time={self.time!r}, delta={self.delta!r}, max_time={self.max_time!r})'

    def advance(self):
        """Advance the simulator clock by DELTA."""
        self.time += self.delta

    def is_running(self):
        """Check if the simulation is running."""
        return self.time <= self.max_time

    def add_agent(self, agent):
        """Register an agent AGENT to the scheduler."""
        self.agents.append(agent)

    def agent_by_id(self, n):
        """Return an agent whose identifier is N.  Th identifier is an integer
        starting from 1."""
        return self.agents[n - 1]

    def cache_zones(self):
        """Refresh the zone information of all agents (i..e., the location of
        grids (zones) in which every agent exists.  The zone information is
        utilized to speed-up the detection of agent-to-agent encounters."""
        self.zone_cache = {}
        for agent in self.agents:
            agent.cache_zone()
@


1.3
log
@*** empty log message ***
@
text
@d7 1
a7 1
# $Id: scheduler.py,v 1.2 2018/10/15 08:45:29 ohsaki Exp ohsaki $
d27 2
a28 1
        return f'<class Scheduler> t:{self.time} d:{self.delta} max:{self.max_time}'
@


1.2
log
@*** empty log message ***
@
text
@d3 1
a3 1
#
d7 1
a7 1
# $Id: scheduler.py,v 1.1 2018/05/27 08:31:34 ohsaki Exp ohsaki $
d10 1
a10 1
VERSION = '1.33'
d13 3
a15 3
    return """
This is pdtnsim, version VERSION.
Copyright (c) 2010-2017, Hiroyuki Ohsaki.
d19 4
a22 4
    def __init__(self):
        self.time = 0  # simulation clock [s]
        self.delta = 10  # slot length [s]
        self.max_time = 10000
d30 1
d34 1
d38 1
d42 2
d47 3
@


1.1
log
@Initial revision
@
text
@d7 1
a7 1
# $Id: python,v 1.5 2018/05/25 15:21:25 ohsaki Exp $
a11 1

d13 2
a14 1
    return """This is pdtnsim, version VERSION.
d16 1
a16 4
All rights reserved.

"""

@
